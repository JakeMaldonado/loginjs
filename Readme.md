# Login.js

Minimalist module built to quickly setup a secure back-end express login system.

## Installation

Before installing, [download and install Node.js](https://nodejs.org/en/download/).

For brand new projects, be sure to create a `package.json` first with the [`npm init` command](<https://docs.npmjs.com> creating-a-package-json-file).

Next, run the following command in your terminal:

```bash
npm install loginjs
```

## Quick Setup

1. Create an `index.js` file, and paste the starter code shown below inside of it.

   ```js
   const loginJS = require('loginjs');

   // required
   const loginConfig = {
   mongodbURI: process.env.MONGODB_URI,
   jwtSecret: process.env.JWT_SECRET,
   };

   const resetConfig = {
   jwtResetSecret: process.env.JWT_RESET_SECRET,
   emailFromUser: process.env.EMAIL_FROM_USER,
   emailFromPass: process.env.EMAIL_FROM_PASS,
   emailHost: process.env.EMAIL_HOST,
   emailPort: process.env.EMAIL_PORT,
   emailSecure: process.env.EMAIL_SECURE,
   };

   // Insert optional customization here if you need it (see below).

   loginJS(loginConfig, resetConfig);
   ```

   These are **optional** should you need to change default values included in Login.js. If so, please add the following to your `index.js`.

   ```js
   // optional
   resetConfig.jwtResetExpiration = parseInt(process.env.JWT_RESET_EXPIRATION); // in seconds
   resetConfig.emailHeading = 'Your Custom Heading';
   resetConfig.emailSubjectLine = 'Reset Password';
   resetConfig.emailMessage ='Custom reset password message goes here. Reset password link will be autogenerated and placed below your message.';

   loginConfig.passwordLength = parseInt(process.env.ACCOUNT_PWD_LENGTH); // positive integer
   loginConfig.jwtSessionExpiration = parseInt(
   process.env.JWT_SESSION_EXPIRATION
   ); // in seconds
   ```

2. Create a `.env` file to store a list of environmental variables needed for this module to run. These are **required**:

   ```js
   MONGODB_URI=mongodb+srv://jdoe:password@cluster0.d312b.mongodb.net/loginjs?retryWrites=true&w=majority
   JWT_SECRET=xyzjwtsec3874r3t
   JWT_RESET_SECRET=mtcjreset56874sec56rt
   EMAIL_FROM_USER=support@loginjs.com
   EMAIL_FROM_PASS=hky34KTcyTyz18
   EMAIL_HOST=smtp.zoho.com
   EMAIL_PORT=465
   EMAIL_SECURE=true
   ```

   These are **optional**:

   ```js
   JWT_SESSION_EXPIRATION = 3600;
   JWT_RESET_EXPIRATION = 600;
   ACCOUNT_PWD_LENGTH = 10;
   ```

## Stand-alone Login System Quick Setup

If you prefer quick access to only the login feature without reset password functionality, then the setup is as follows:

1. Create an `index.js` file, and paste the starter code shown below inside of it.

   ```js
   const loginJS = require('./index');
   const createLogin = loginJS.createLogin;

   // required
   const loginConfig = {
   mongodbURI: process.env.MONGODB_URI,
   jwtSecret: process.env.JWT_SECRET,
   };

   // Insert optional customization here if you need it (see below).

   // Login system without reset password feature
   createLogin(loginConfig, launchApp = true);
   ```

   These are **optional** should you need to change default values included in Login.js. If so, please add the following to your `index.js`.

   ```js
   loginConfig.passwordLength = parseInt(process.env.ACCOUNT_PWD_LENGTH); // positive integer
   loginConfig.jwtSessionExpiration = parseInt(
   process.env.JWT_SESSION_EXPIRATION
   ); // in seconds
   ```

2. Create a `.env` file to store a list of environmental variables needed for this module to run. These are **required**:

   ```js
   MONGODB_URI=mongodb+srv://jdoe:password@cluster0.d312b.mongodb.net/loginjs?retryWrites=true&w=majority
   JWT_SECRET=xyzjwtsec3874r3t
   ```

   These are **optional**:

   ```js
   JWT_SESSION_EXPIRATION = 3600;
   ACCOUNT_PWD_LENGTH = 10;
   ```

## Features

- Member sign up and sign In

- Member gravatar

- Encrypted password storage in MongoDB

- Member authentication and reset password

- Reset password email sent to member

## API Endpoints

To test these endpoints, I would higly recommend using Postman as per illustrations below:

1. Register Member

   ```text
   POST: /api/register
   ```

2. Get Authorized Member

   ```text
   GET: /api/login
   ```

3. Sign In Member

   ```text
   POST: /api/login
   ```

4. Forgot Password

   ```text
   PUT: /api/forgot-password
   ```

5. Reset Password

   ```text
   PATCH: /api/reset-password
   ```

## MongoDB Setup

Login.js integrates with MongoDB. Before running Login.js module, be sure to lauch a MongoDB server and provide its URI as an environmental variable in `.env` file (discussed above).

Alternatively, I recommend setting up a [MongoDB Cloud Cluster.](https://www.mongodb.com/cloud)

## Security Issues

If you discover a security vulnerability or would like to help me improve Login.js, please email me at: anisxmerchant(at)gmail(dot)com. Alternatively, submit a pull request at this project's github, and we'll go from there. Thank you for your support.

## Testing Endpoints in Postman (illustrations)

### 1. Register Member

![register-member](https://user-images.githubusercontent.com/5770541/97410926-08860180-18d6-11eb-920e-06bb6631dca6.png)

### 2. Get Authorized Member Information

![get-auth-member](https://user-images.githubusercontent.com/5770541/97410996-16d41d80-18d6-11eb-8c14-b8a7afb0a8a3.png)

### 3. Sign In Member

![signin-member](https://user-images.githubusercontent.com/5770541/97410968-1045a600-18d6-11eb-9e08-ce4f97410f7d.png)

### 4. Forgot Password

![forgot-password](https://user-images.githubusercontent.com/5770541/97411338-82b68600-18d6-11eb-8b80-b4dbc5a446ba.png)

### 5. Reset Password

![reset-password](https://user-images.githubusercontent.com/5770541/97411387-93ff9280-18d6-11eb-8248-718aefc2bfab.png)

### 6. Reset Password Email Sent to Member

![reset-email](https://user-images.githubusercontent.com/5770541/97411343-8518e000-18d6-11eb-81df-00cec595d572.png)
